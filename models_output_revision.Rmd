---
title: 'Revised code for potential submission'
author: "Sofi Sinozich & Rachael Jackson"
date: "12/8/2020"
output:
  word_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message=FALSE)
```

```{r echo=FALSE}
full_data <- readRDS("data/full_data.rds")
```

# Descriptives

```{r}
# Physicians x health status
full_data %>% filter(!is.na(health_status2) & !is.na(examiner_id)) %>% group_by(examiner_id) %>% count(health_status2) %>% 
  ggplot + geom_bar(aes(x = health_status2,y=n),stat="identity") + 
  geom_label(aes(x=health_status2,y=n+10,label=n)) + facet_wrap(.~examiner_id)

full_data %>% filter(!is.na(health_status2evg) & !is.na(examiner_id)) %>% group_by(examiner_id) %>% count(health_status2evg) %>% 
  ggplot + geom_bar(aes(x = health_status2evg,y=n,fill=ifelse(health_status2evg==1,"Excellent/Very Good","Good/Fair/Poor")),stat="identity") + 
  geom_label(aes(x=health_status2evg,y=n+500,label=n,
                 vjust=case_when(examiner_id==3007 & health_status2evg==1 ~ 1.25,
                                 n < 500 ~ .5,
                                 TRUE ~ 1)),
             size=3) + 
  scale_y_continuous(expand = c(0, 0), limits = c(0, NA)) +
  labs(fill = "Status",
       x="",y="Patients Evaluated") +
  theme_light() +
  theme(legend.position="top",
        legend.title = element_text(size = 8, face="bold"),
        legend.text = element_text(size = 8),
        axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank()) +
  guides(fill = guide_legend(override.aes = list(size=5))) +
  facet_wrap(.~examiner_id) +
  ggtitle("Patients' Physician-Rated Health Status by Examining Physician")


# Physicians x referral status

```

